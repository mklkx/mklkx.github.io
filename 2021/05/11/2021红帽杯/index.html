<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="author" content="煤矿路口西"><link rel="alternative" href="/atom.xml" title="The blog of mklkx" type="application/atom+xml"><link rel="icon" href="/favicon.svg"><title>2021红帽杯 - The blog of mklkx</title>
<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="/js/fancybox/jquery.fancybox.min.css">
<!--[if lt IE 9]><script>(function(a,b){a="abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video".split(" ");for(b=a.length-1;b>=0;b--)document.createElement(a[b])})()</script><![endif]-->
<script src="/js/jquery-3.1.1.min.js"></script>

<script src="/js/fancybox/jquery.fancybox.min.js"></script>
<meta name="generator" content="Hexo 5.4.0"></head><body style="opacity:0"><header class="head"><h1 class="head-title u-fl"><a href="/">The blog of mklkx</a></h1><nav class="head-nav u-fr"><ul class="head-nav__list"><li class="head-nav__item"><a class="head-nav__link" href="/tags">标签</a></li><li class="head-nav__item"><a class="head-nav__link" href="/archives">目录</a></li><li class="head-nav__item"><a class="head-nav__link" href="/friends">友链</a></li></ul></nav></header><main class="main"><article class="post"><header class="post__head"><time class="post__time" datetime="2021-05-11T06:31:40.000Z">2021 - 05 - 11 14:31:40</time><h1 class="post__title"><a href="/2021/05/11/2021%E7%BA%A2%E5%B8%BD%E6%9D%AF/">2021红帽杯</a></h1><div class="post__main echo"><h3><span id="2021红帽杯">2021红帽杯</span></h3>
<hr>
<h4><span id="签到">签到</span></h4>
<p>根据文件名提示，</p>
<p>把txt拖进010editor，</p>
<p>更改编码方式为【EBCDIC】</p>
<p>flag{we1c0me_t0_redhat2021}</p>
<h4><span id="colorful-code">colorful code</span></h4>
<p>附件得到两个data</p>
<p>一个全是数字，一个是十六进制</p>
<p>结合题目【colorful】</p>
<p>猜测为图片隐写</p>
<p>1）如何形成图片data2开头为【000000】</p>
<p><img src="1.png" alt="1"></p>
<p>猜测为RGB，相当于字典</p>
<p>而data1为索引值，数字对应data2中的第几组数据。</p>
<p>接下来是长宽的问题</p>
<p>尝试了很多方式，</p>
<p>发现data1的长度为7068，微调后发现【7067=37*191】</p>
<p>脚本如下</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">from PIL import Image</span><br><span class="line">im &#x3D; open(&quot;data1&quot;,&quot;r&quot;)</span><br><span class="line">mark &#x3D; im.readline().split(&#39; &#39;)</span><br><span class="line">print(mark)</span><br><span class="line">print(len(mark))</span><br><span class="line">c &#x3D; [(0,0,0),(0,0,192),(0,255,255),(0,255,0),(255,192,255),(255,192,192),(192,192,255),(192,192,0),(255,0,255),(255,0,0),(192,0,0),(192,0,192),(255,255,255),(255,255,0),(255,255,192),(0,192,0),(0,192,192),(192,255,255),(192,255,192),(0,0,255)]</span><br><span class="line">pic &#x3D; Image.new(&quot;RGB&quot;,(37,191))</span><br><span class="line">k&#x3D;0</span><br><span class="line">for i in range(37):</span><br><span class="line">    for j in range(191):</span><br><span class="line">        pic.putpixel((int(i),int(j)),c[int(mark[k])])</span><br><span class="line">        k +&#x3D; 1</span><br><span class="line">pic.save(&#39;flag.png&#39;)</span><br></pre></td></tr></table></figure>
<p>得到png</p>
<p><img src="2.png" alt="2"></p>
<p>找到解密网站https://www.bertnase.de/npiet/npiet-execute.php</p>
<p>得到flag</p>
<p><img src="3.png" alt="3"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">88842f20-fb8c-45c9-ae8f-36135b6a0f11</span><br></pre></td></tr></table></figure>
<p>加flag头上交</p>
</div></header><footer class="post__foot u-cf"><ul class="post__tag u-fl"><li class="post__tag__item"><a class="post__tag__link" href="/tags/challenge/">challenge</a></li><li class="post__tag__item"><a class="post__tag__link" href="/tags/MISC/">MISC</a></li></ul></footer></article><div class="comments" id="v-container"><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="/js/Valine.min.js"></script>
<script>new Valine({
  av: AV,
  el: '#v-container',
  app_id: '2VYdBl7nzsDwGBpC7KummVUd-gzGzoHsz',
  app_key: 'L0QfImQHhdbw4LhAjSrOLbWG',
  avatar: 'retro',
  avatarForce: false,
  notify: false,
  verify: false,
  lang: 'zh-cn',
  placeholder: 'balabala~',
  pageSize: 10,
  visitor: true,
  highlight: true,
  emoticon_url: '/img/alu',
  emoticon_list: ["吐.png","喷血.png","狂汗.png","不说话.png","汗.png","坐等.png","献花.png","不高兴.png","中刀.png","害羞.png","皱眉.png","小眼睛.png","中指.png","尴尬.png","瞅你.png","想一想.png","中枪.png","得意.png","肿包.png","扇耳光.png","亲亲.png","惊喜.png","脸红.png","无所谓.png","便便.png","愤怒.png","蜡烛.png","献黄瓜.png","内伤.png","投降.png","观察.png","看不见.png","击掌.png","抠鼻.png","邪恶.png","看热闹.png","口水.png","抽烟.png","锁眉.png","装大款.png","吐舌.png","无奈.png","长草.png","赞一个.png","呲牙.png","无语.png","阴暗.png","不出所料.png","咽气.png","期待.png","高兴.png","吐血倒地.png","哭泣.png","欢呼.png","黑线.png","喜极而泣.png","喷水.png","深思.png","鼓掌.png","暗地观察.png"],
});</script></div></main><footer class="foot"><div class="foot-copy">&copy; 2019 - 2021 煤矿路口西</div></footer>
<script src="/js/scroller.js"></script>

<script src="/js/main.js"></script>
</body></html>