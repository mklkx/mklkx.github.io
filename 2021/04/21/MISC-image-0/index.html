<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="author" content="煤矿路口西"><link rel="alternative" href="/atom.xml" title="The blog of mklkx" type="application/atom+xml"><link rel="icon" href="/favicon.svg"><title>MISC-image-0 - The blog of mklkx</title>
<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="/js/fancybox/jquery.fancybox.min.css">
<!--[if lt IE 9]><script>(function(a,b){a="abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video".split(" ");for(b=a.length-1;b>=0;b--)document.createElement(a[b])})()</script><![endif]-->
<script src="/js/jquery-3.1.1.min.js"></script>

<script src="/js/fancybox/jquery.fancybox.min.js"></script>
<meta name="generator" content="Hexo 5.4.0"></head><body style="opacity:0"><header class="head"><h1 class="head-title u-fl"><a href="/">The blog of mklkx</a></h1><nav class="head-nav u-fr"><ul class="head-nav__list"><li class="head-nav__item"><a class="head-nav__link" href="/tags">标签</a></li><li class="head-nav__item"><a class="head-nav__link" href="/archives">目录</a></li><li class="head-nav__item"><a class="head-nav__link" href="/friends">友链</a></li></ul></nav></header><main class="main"><article class="post"><header class="post__head"><time class="post__time" datetime="2021-04-21T01:43:15.000Z">2021 - 04 - 21 09:43:15</time><h1 class="post__title"><a href="/2021/04/21/MISC-image-0/">MISC-image-0</a></h1><div class="post__main echo"><h1><span id="image0">image[0]</span></h1>
<hr>
<p><img src="0.png" alt="0"></p>
<p>一张Png的百种姿势</p>
<h2><span id="1bpg">1：bpg</span></h2>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">工具：bpg-0.9.8-win64</span><br><span class="line"></span><br><span class="line">命令：bpgdec -o out.png misc3.bpg</span><br></pre></td></tr></table></figure>
<h2><span id="2idat块异常">2：IDAT块异常</span></h2>
<p><img src="2-1.png" alt="2-1"></p>
<p>IDAT未满65524就有下一个数据块了，说明有问题</p>
<p>delete后得到</p>
<p><img src="2-2.png" alt="2-2"></p>
<h2><span id="3idat长度转ascii">3：IDAT长度转ASCII</span></h2>
<h2><span id="4pngdebugger校验crc32">4：pngdebugger校验crc32</span></h2>
<p>错误的crc-code串联转ascii</p>
<p>CRC OK!   ===》   1</p>
<p>CRC FAILED   ===》   0</p>
<h2><span id="5image爆破长宽">5：image爆破长宽</span></h2>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import struct</span><br><span class="line">import zlib</span><br><span class="line">for i in range(4096):</span><br><span class="line">    for j in range(4096):</span><br><span class="line">        c &#x3D; bytes.fromhex(&#39;4948445200000384000000960802000000&#39;)# IHDR</span><br><span class="line">        ihdr &#x3D; c[:4]+struct.pack(&#39;&gt;i&#39;,i)+struct.pack(&#39;&gt;i&#39;,j)+c[12:]</span><br><span class="line">        crc &#x3D; 0x5255A798# CRC32</span><br><span class="line">        if zlib.crc32(ihdr) &#x3D;&#x3D; crc:</span><br><span class="line">            print(hex(i),hex(j))</span><br><span class="line">            exit(0)</span><br></pre></td></tr></table></figure>
<p><img src="3-1.png" alt="3-1"></p>
<h2><span id="6png爆破高度">6：png爆破高度</span></h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line">misc = <span class="built_in">open</span>(<span class="string">&quot;misc26.png&quot;</span>, <span class="string">&quot;rb&quot;</span>).read()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 爆破宽</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1024</span>):</span><br><span class="line">    data = misc[<span class="number">12</span>:<span class="number">16</span>] + struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>,i)+ misc[<span class="number">20</span>:<span class="number">29</span>]  <span class="comment">#IHDR数据</span></span><br><span class="line">    crc32 = binascii.crc32(data) &amp; <span class="number">0xffffffff</span></span><br><span class="line">    <span class="keyword">if</span> crc32 == <span class="number">0xEC9CCBC6</span>: <span class="comment">#IHDR块的crc32值</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;weight&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(i)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;hex:&quot;</span>+<span class="built_in">hex</span>(i))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 爆破高</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1024</span>):</span><br><span class="line">    data = misc[<span class="number">12</span>:<span class="number">20</span>] + struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>,i)+ misc[<span class="number">24</span>:<span class="number">29</span>]</span><br><span class="line">    crc32 = binascii.crc32(data) &amp; <span class="number">0xffffffff</span></span><br><span class="line">    <span class="keyword">if</span> crc32 == <span class="number">0xEC9CCBC6</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;height&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(i)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;hex:&quot;</span>+<span class="built_in">hex</span>(i))</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line"><span class="comment">#height</span></span><br><span class="line"><span class="comment">#606</span></span><br><span class="line"><span class="comment">#hex:0x25e</span></span><br></pre></td></tr></table></figure>
<h2><span id="7bmp修改高度">7：bmp修改高度</span></h2>
<p><img src="4-1.png" alt="4-1"></p>
<p><img src="4-2.png" alt="4-2"></p>
<p>12-15：4字节的biWidth，这里是0x00000280，即十进制的640，用像素表示图像的宽度，查看文件信息验证正确；
16-19：4字节的biHeight，这里是0x000001E0，即十进制的480，用像素表示图像的高度，查看文件信息验证正确；同时，这是一个正数，表示图像是倒立的，即图像数据是从左下角到右上角排列的；</p>
<h2><span id="8jpg修改高度">8：jpg修改高度</span></h2>
<p><img src="5-1.png" alt="5-1"></p>
<h2><span id="9gif修改高度">9：gif修改高度</span></h2>
<p><img src="6-1.png" alt="6-1"></p>
<p>后分离帧得到flag</p>
<h2><span id="10bmp爆破宽度">10：bmp爆破宽度</span></h2>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import struct</span><br><span class="line">import zlib</span><br><span class="line">f &#x3D; open(&#39;misc31.bmp&#39;,&#39;rb&#39;)</span><br><span class="line">c &#x3D; f.read()</span><br><span class="line">width &#x3D; c[18:22]</span><br><span class="line">height &#x3D; c[22:26]</span><br><span class="line"># 爆破bmp宽度</span><br><span class="line">for i in range(900,1100):</span><br><span class="line">    f1 &#x3D; open(str(i)+&#39;.bmp&#39;,&#39;wb&#39;)</span><br><span class="line">    # print(struct.pack(&#39;&gt;i&#39;,i)[::-1])</span><br><span class="line">    img &#x3D; c[:18]+struct.pack(&#39;&gt;i&#39;,i)[::-1]+c[22:]</span><br><span class="line">    f1.write(img)</span><br><span class="line">    f1.close()</span><br></pre></td></tr></table></figure>
<h2><span id="11png爆破宽度">11：png爆破宽度</span></h2>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import struct</span><br><span class="line">import zlib</span><br><span class="line">#爆破png宽度</span><br><span class="line">f &#x3D; open(r&#39;misc34.png&#39;,&#39;rb&#39;)</span><br><span class="line">c &#x3D; f.read()</span><br><span class="line">width &#x3D; c[16:20]</span><br><span class="line">height &#x3D; c[20:24]</span><br><span class="line">for i in range(900,1200):</span><br><span class="line">    f1 &#x3D; open(str(i)+&#39;.png&#39;,&#39;wb&#39;)</span><br><span class="line">    # print(struct.pack(&#39;&gt;i&#39;,i)[::-1])</span><br><span class="line">    img &#x3D; c[:16]+struct.pack(&#39;&gt;i&#39;,i)+c[20:]</span><br><span class="line">    f1.write(img)</span><br><span class="line">    f1.close()</span><br></pre></td></tr></table></figure>
<h2><span id="12遇到binwalk有东西但分离不出的情况">12：遇到binwalk有东西，但分离不出的情况</span></h2>
<p><img src="11-1.png" alt="11-1"></p>
<p>根据binwalk提示，尝试手动分离</p>
<h2><span id="13zsteg">13：zsteg</span></h2>
<p>首先尝试binwalk -e</p>
<p>发现bzip2</p>
<p><img src="12-1.png" alt="12-1"></p>
<p>进一步binwalk却始终存在问题</p>
<hr>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">zsteg misc17.png</span><br></pre></td></tr></table></figure>
<p>得到应该分离的数据段</p>
<p><img src="12-2.png" alt="12-2"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">zsteg -e &quot;extradata:0&quot; &#x2F;root&#x2F;桌面&#x2F;misc17.png &gt; 1.txt</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">binwalk -e 1.txt</span><br></pre></td></tr></table></figure>
<h2><span id="14exiftool查看附加信息">14：exiftool查看附加信息</span></h2>
<h2><span id="15gif考虑时间间隔3637gtgt01">15：gif考虑时间间隔/3637&gt;&gt;01</span></h2>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">identify -format &quot;%T&quot; misc39.gif &gt; 1</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#coding&#x3D;utf-8</span><br><span class="line">text&#x3D;&#39;737363636373737373736373636373736363737363737373636373737373637363636373736373737373737373637373737373737363737363737363736373637373636373636373737363636363737363636373637373636373637373636373736373736363737363637373736363736373737363637363737363736373737363637373637373636363736363737363737373737363636373637373636373637363737363637363637373637373636373737363636373736363736363637373736363736373736373736363737363637373737363636363736373737363637373736363736373737363636373637373636363737373736363636373637373636363636373736373636363737363736373637373736363737373737373637&#39;.split(&#39;3&#39;)</span><br><span class="line">print(text)</span><br><span class="line">firstType &#x3D; &#39;6&#39;</span><br><span class="line">secondType &#x3D; &#39;7&#39;</span><br><span class="line">binaryString &#x3D; &#39;&#39;</span><br><span class="line"></span><br><span class="line">for char in text: #Foreach char</span><br><span class="line">    if char &#x3D;&#x3D; firstType: #Check if it is the first type</span><br><span class="line">        binaryString +&#x3D; &#39;0&#39; #Mark it as 0</span><br><span class="line">        # print(char)</span><br><span class="line">    else:</span><br><span class="line">        binaryString +&#x3D; &#39;1&#39; #Mark it as 1</span><br><span class="line">        # print(char)</span><br><span class="line"></span><br><span class="line">print(binaryString) #Print result</span><br><span class="line">print((len(binaryString)-1)&#x2F;7)</span><br><span class="line"></span><br><span class="line">binary&#x3D;&#39;&#39;</span><br><span class="line">for i in range(41):</span><br><span class="line">    binary +&#x3D; binaryString[7*i:7*i+7] + &#39; &#39;</span><br><span class="line">print(binary)</span><br><span class="line">#1100011 1110100 1100110 1110011 1101000 1101111 1110111 1111011 0110101 0110010 0111000 0110001 0110010 1100110 1100110 0111001 0111001 0110101 1100110 1100010 0110111 1100010 1100101 0110010 0110110 0111000 1100100 0111001 0110110 0110011 1100001 0111001 1100101 1100010 1100011 1100001 0110000 0110100 0110101 0111001 1111101 </span><br></pre></td></tr></table></figure>
<h2><span id="16lsb改变通道改变排序方式">16：LSB改变通道，改变排序方式</span></h2>
<h2><span id="17base">17：base</span></h2>
<h1><span id="脑洞部分">脑洞部分</span></h1>
<h2><span id="1010按位取">1：010按位取</span></h2>
<p><img src="1-1.png" alt="1-1"></p>
<h2><span id="2所有头的hex都该熟悉各种hex魔转">2：所有头的hex都该熟悉,各种hex魔转</span></h2>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Serial Number                   : 686578285826597329</span><br></pre></td></tr></table></figure>
<p>686578285826597329=》hex(X&amp;Ys)</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">X Resolution                    : 3902939465</span><br><span class="line">Y Resolution                    : 2371618619</span><br><span class="line">X Position                      : 1082452817</span><br><span class="line">Y Position                      : 2980145261</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; print(hex(x))</span><br><span class="line">0xe8a22149</span><br><span class="line">&gt;&gt;&gt; print(hex(y))</span><br><span class="line">0x8d5c073b</span><br><span class="line">&gt;&gt;&gt; print(hex(a))</span><br><span class="line">0x4084eb51</span><br><span class="line">&gt;&gt;&gt; print(hex(b))</span><br><span class="line">0xb1a1686d</span><br></pre></td></tr></table></figure>
</div></header><footer class="post__foot u-cf"><ul class="post__tag u-fl"><li class="post__tag__item"><a class="post__tag__link" href="/tags/MISC/">MISC</a></li></ul></footer></article><div class="comments" id="v-container"><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="/js/Valine.min.js"></script>
<script>new Valine({
  av: AV,
  el: '#v-container',
  app_id: '2VYdBl7nzsDwGBpC7KummVUd-gzGzoHsz',
  app_key: 'L0QfImQHhdbw4LhAjSrOLbWG',
  avatar: 'retro',
  avatarForce: false,
  notify: false,
  verify: false,
  lang: 'zh-cn',
  placeholder: 'balabala~',
  pageSize: 10,
  visitor: true,
  highlight: true,
  emoticon_url: '/img/alu',
  emoticon_list: ["吐.png","喷血.png","狂汗.png","不说话.png","汗.png","坐等.png","献花.png","不高兴.png","中刀.png","害羞.png","皱眉.png","小眼睛.png","中指.png","尴尬.png","瞅你.png","想一想.png","中枪.png","得意.png","肿包.png","扇耳光.png","亲亲.png","惊喜.png","脸红.png","无所谓.png","便便.png","愤怒.png","蜡烛.png","献黄瓜.png","内伤.png","投降.png","观察.png","看不见.png","击掌.png","抠鼻.png","邪恶.png","看热闹.png","口水.png","抽烟.png","锁眉.png","装大款.png","吐舌.png","无奈.png","长草.png","赞一个.png","呲牙.png","无语.png","阴暗.png","不出所料.png","咽气.png","期待.png","高兴.png","吐血倒地.png","哭泣.png","欢呼.png","黑线.png","喜极而泣.png","喷水.png","深思.png","鼓掌.png","暗地观察.png"],
});</script></div></main><footer class="foot"><div class="foot-copy">&copy; 2019 - 2021 煤矿路口西</div></footer>
<script src="/js/scroller.js"></script>

<script src="/js/main.js"></script>
</body></html>