<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="author" content="煤矿路口西"><link rel="alternative" href="/atom.xml" title="The blog of mklkx" type="application/atom+xml"><link rel="icon" href="/favicon.svg"><title>MISC-data-2 - The blog of mklkx</title>
<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="/js/fancybox/jquery.fancybox.min.css">
<!--[if lt IE 9]><script>(function(a,b){a="abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video".split(" ");for(b=a.length-1;b>=0;b--)document.createElement(a[b])})()</script><![endif]-->
<script src="/js/jquery-3.1.1.min.js"></script>

<script src="/js/fancybox/jquery.fancybox.min.js"></script>
<meta name="generator" content="Hexo 5.4.0"></head><body style="opacity:0"><header class="head"><h1 class="head-title u-fl"><a href="/">The blog of mklkx</a></h1><nav class="head-nav u-fr"><ul class="head-nav__list"><li class="head-nav__item"><a class="head-nav__link" href="/tags">标签</a></li><li class="head-nav__item"><a class="head-nav__link" href="/archives">目录</a></li><li class="head-nav__item"><a class="head-nav__link" href="/friends">友链</a></li></ul></nav></header><main class="main"><article class="post"><header class="post__head"><time class="post__time" datetime="2021-03-22T12:32:24.000Z">2021 - 03 - 22 20:32:24</time><h1 class="post__title"><a href="/2021/03/22/MISC-data-2/">MISC-data-2</a></h1><div class="post__main echo"><h3 id="Data-2"><a href="#Data-2" class="headerlink" title="Data[2]"></a>Data[2]</h3><hr>
<h3 id="21"><a href="#21" class="headerlink" title="21"></a><em>21</em></h3><h4 id="XMAN2018排位赛-file"><a href="#XMAN2018排位赛-file" class="headerlink" title="[XMAN2018排位赛]file"></a><a target="_blank" rel="noopener" href="https://buuoj.cn/challenges#[XMAN2018%E6%8E%92%E4%BD%8D%E8%B5%9B]file">[XMAN2018排位赛]file</a></h4><blockquote>
<p>得到的 flag 请包上 flag{} 提交。来源：<a target="_blank" rel="noopener" href="https://github.com/hebtuerror404/CTF_competition_warehouse_2018">https://github.com/hebtuerror404/CTF_competition_warehouse_2018</a></p>
</blockquote>
<p>得到attachment.img</p>
<p>第一感觉是volatility,失败</p>
<p>学到了新招</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">extundelete attachment.img --restore-all</span><br></pre></td></tr></table></figure>

<p>恢复被删除的目录或文件</p>
<p>得到RECOVERED_FILES/file.17</p>
<p><img src="6CpQmT.png" alt="6CpQmT"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">flag&#123;fugly_cats_need_luv_2&#125;</span><br></pre></td></tr></table></figure>

<h3 id="22"><a href="#22" class="headerlink" title="22"></a><em>22</em></h3><h4 id="greatescape"><a href="#greatescape" class="headerlink" title="greatescape"></a><a target="_blank" rel="noopener" href="https://buuoj.cn/challenges#greatescape">greatescape</a></h4><blockquote>
<p>得到的 flag 请包上 flag{} 提交。</p>
</blockquote>
<p>不明所以，稍作记录。</p>
<p>得到一个数据包，通过追踪发现存在ssc.key，格式类似rsa私钥，另存为</p>
<p>编辑-&gt;首选项-&gt;protocols-&gt;TLS 把刚才的key通过本地导入</p>
<p>追踪http得到flag</p>
<h3 id="23"><a href="#23" class="headerlink" title="23"></a><em>23</em></h3><h4 id="BSidesSF2019-diskimage"><a href="#BSidesSF2019-diskimage" class="headerlink" title="[BSidesSF2019]diskimage"></a><a target="_blank" rel="noopener" href="https://buuoj.cn/challenges#[BSidesSF2019]diskimage">[BSidesSF2019]diskimage</a></h4><blockquote>
<p>得到的 flag 请包上 flag{} 提交。</p>
</blockquote>
<p>得到一张图片</p>
<p>binwalk foremost都无果的情况下</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">zsteg -a diskimage.png</span><br></pre></td></tr></table></figure>

<p><img src="6iNTjH.png" alt="6iNTjH"></p>
<p>“b8,rgb,lsb,xy”中存在东西</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">zsteg -e &#39;b8,rgb,lsb,xy&#39; diskimage.png &gt; disk.dat</span><br></pre></td></tr></table></figure>

<p>导出</p>
<p>用testdisk进行分析</p>
<p><img src="6iU1V1.png" alt="6iU1V1"></p>
<p>回车</p>
<p><img src="6iU3Ux.png" alt="6iU3Ux"></p>
<p>回车</p>
<p><img src="6iU856.png" alt="6iU856"></p>
<p>找到其中最与众不同的那一个</p>
<p>根据提示，按C拷贝到想要的位置</p>
<p>查看</p>
<p><img src="6iUJPK.png" alt="6iUJPK"></p>
<p>得到flag</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">CTF&#123;FAT12_FTW&#125;</span><br></pre></td></tr></table></figure>

<h3 id="24"><a href="#24" class="headerlink" title="24"></a><em>24</em></h3><h4 id="RCTF2019-disk"><a href="#RCTF2019-disk" class="headerlink" title="[RCTF2019]disk"></a><a target="_blank" rel="noopener" href="https://buuoj.cn/challenges#[RCTF2019]disk">[RCTF2019]disk</a></h4><blockquote>
<p>得到的 flag 请包上 flag{} 提交。</p>
</blockquote>
<p>得到encrypt.vmdk</p>
<p>一时没有方向，拖进010看到</p>
<p><code>rctf&#123;unseCure_quick_form4t_vo1ume</code></p>
<p>试图打开vmdk却被告知压缩包已损坏</p>
<p>这里学到一招，可以用7z</p>
<p><a target="_blank" rel="noopener" href="https://sparanoid.com/lab/7z/">https://sparanoid.com/lab/7z/</a></p>
<p>可以看到有一个0.fat</p>
<p>但无法直接操作</p>
<p>通过‘提取’得到0.fat</p>
<p><img src="6VXsun.png" alt="6VXsun"></p>
<p>[FAT文件可以使用VeraCrypto进行挂载]</p>
<p><a target="_blank" rel="noopener" href="https://www.veracrypt.fr/en/Downloads.html">https://www.veracrypt.fr/en/Downloads.html</a></p>
<p>存在密码，rctf能解</p>
<p>到这一步挂载成功：</p>
<p><img src="6VXouR.png" alt="6VXouR"></p>
<p>看看是啥：</p>
<p><img src="6VXouR.png" alt="6VXouR"></p>
<p>给了另一个密码：RCTF2019</p>
<p>这里体现了神奇之处：在挂载输入密码的时候，不同的密码可以进入不同的文件系统</p>
<p>重新挂载：</p>
<p>却被告知无法访问，需要格式化等</p>
<p>参考之前，但无法直接拖入010，换winhex试试</p>
<p>winhex-&gt;Tools-&gt;Open Disk-&gt;Select Disk,选择挂载的盘</p>
<p>得到后半部分</p>
<p> <code>_and_corrupted_1nner_v0lume&#125;</code></p>
<p>  <code>rctf&#123;unseCure_quick_form4t_vo1ume_and_corrupted_1nner_v0lume&#125;</code></p>
<h3 id="25"><a href="#25" class="headerlink" title="25"></a><em>25</em></h3><h4 id="V-amp-N2020-公开赛-内存取证"><a href="#V-amp-N2020-公开赛-内存取证" class="headerlink" title="[V&amp;N2020 公开赛]内存取证"></a><a target="_blank" rel="noopener" href="https://buuoj.cn/challenges#[V&N2020%20%E5%85%AC%E5%BC%80%E8%B5%9B]%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81">[V&amp;N2020 公开赛]内存取证</a></h4><blockquote>
<p><a target="_blank" rel="noopener" href="http://dd.zhaoj.in/3ehg38dgey84d3dhou32d3/mem.raw">http://dd.zhaoj.in/3ehg38dgey84d3dhou32d3/mem.raw</a><br>得到的 flag 请包上 flag{} 提交。<br>Hint:记事本</p>
</blockquote>
<p>这是一道复现地很费劲的题😂</p>
<p>得到mem.raw和VOL(VOL对应后面链接失效的地方,按下不表)</p>
<p>内存取证起手式：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">volatility -f mem.raw imageinfo</span><br></pre></td></tr></table></figure>

<p>得到可能版本后</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">volatility -f mem.raw --profile&#x3D;Win7SP1x86_23418 pslist</span><br></pre></td></tr></table></figure>

<p>查看进程</p>
<p><img src="6mEkTO.png" alt="6mEkTO"></p>
<p>关注</p>
<p>TrueCrypt.exe   3364<br>notepad.exe     3552<br>mspaint.exe     2648</p>
<p>分别dumpit</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">volatility -f mem.raw --profile&#x3D;Win7SP1x86_23418 memdump -p 3364 --dump-dir&#x3D;.&#x2F;</span><br><span class="line"></span><br><span class="line">volatility -f mem.raw --profile&#x3D;Win7SP1x86_23418 memdump -p 3552 --dump-dir&#x3D;.&#x2F;</span><br><span class="line"></span><br><span class="line">volatility -f mem.raw --profile&#x3D;Win7SP1x86_23418 memdump -p 2648 --dump-dir&#x3D;.&#x2F;</span><br></pre></td></tr></table></figure>

<p>挨个看</p>
<p>1)mspaint</p>
<p>此处需要用到Gimp工具，一个类似画图的工具得到密码：</p>
<p>1YxfCQ6goYBD6Q</p>
<p>2)notepad</p>
<p>使用editbox插件</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">volatility -f mem.raw --profile&#x3D;Win7SP1x86_23418 editbox</span><br></pre></td></tr></table></figure>

<p><img src="6mVbIU.png" alt="6mVbIU"></p>
<p>得到网盘链接，但已失效，对应题干中的VOL</p>
<p>3)TrueCrypt</p>
<p>TrueCrypt破解工具Elcomsoft Forensic Disk Decryptor</p>
<p>Decrypt or mount disk-&gt;TrueCrypt-&gt;select&amp;Memory dump&amp;Browse-&gt;mount</p>
<p>发现多了个盘，其中存在key</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">uOjFdKu1jsbWI8N51jsbWI8N5</span><br></pre></td></tr></table></figure>

<p>得到VOL的时候就该想到需要挂载，使用VeraCrypt,按之前学到的用法</p>
<p>此处注意需要勾选TrueCrypt</p>
<p><img src="6me96s.png" alt="6me96s"></p>
<p>得到fffflag.zip</p>
<p>fffflag</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">RoarCTF&#123;wm_D0uB1e_TC-cRypt&#125;</span><br></pre></td></tr></table></figure>

</div></header><footer class="post__foot u-cf"><ul class="post__tag u-fl"><li class="post__tag__item"><a class="post__tag__link" href="/tags/MISC/">MISC</a></li></ul></footer></article><section class="reward"><a class="btn-reward" href="#">打赏</a><div class="reward-wrapper clearfix"><img src="/img/wechat.jpg" title="微信"></div></section></main><footer class="foot"><div class="foot-copy">&copy; 2016 - 2021 煤矿路口西</div></footer>
<script src="/js/scroller.js"></script>

<script src="/js/main.js"></script>
</body></html>