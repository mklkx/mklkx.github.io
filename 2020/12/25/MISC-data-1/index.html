<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="Hexo Theme Keep">
    <meta name="author" content="煤矿路口西">
    
    <title>
        
            MISC-data-1 |
        
        The blog of mklkx
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="shortcut icon" href="/images/favicon.svg">
    
<link rel="stylesheet" href="/css/font-awesome.min.css">

    <script id="hexo-configurations">
    let KEEP = window.KEEP || {};
    KEEP.hexo_config = {"hostname":"mklkx.github.io","root":"/","language":"zh-CN","path":"search.json"};
    KEEP.theme_config = {"toc":{"enable":true,"number":true,"expand_all":true,"init_open":false},"style":{"primary_color":"#0066CC","avatar":"/images/logo.jpg","favicon":"/images/favicon.svg","article_img_align":"left","left_side_width":"260px","content_max_width":"920px","hover":{"shadow":false,"scale":false},"first_screen":{"enable":"enable","background_img":"/images/bg.svg","description":"(⌐■_■)"},"scroll":{"progress_bar":{"enable":"enable"},"percent":{"enable":"enable"}}},"local_search":{"enable":true,"preload":true},"code_copy":{"enable":true,"style":"default"},"pjax":{"enable":true},"lazyload":{"enable":true},"version":"3.4.3"};
    KEEP.language_ago = {"second":"%s 秒前","minute":"%s 分钟前","hour":"%s 小时前","day":"%s 天前","week":"%s 周前","month":"%s 月前","year":"%s 年前"};
  </script>
<meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="The blog of mklkx" type="application/atom+xml">
</head>


<body>
<div class="progress-bar-container">
    

    
        <span class="pjax-progress-bar"></span>
        <span class="pjax-progress-icon">
            <i class="fas fa-circle-notch fa-spin"></i>
        </span>
    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            <header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            
            <a class="logo-title" href="/">
                The blog of mklkx
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                首页
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                归档
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/tags"
                            >
                                标签
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/links"
                            >
                                友链
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/about"
                            >
                                关于
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">首页</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">归档</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/tags">标签</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/links">友链</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/about">关于</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="article-content-container">

        <div class="article-title">
            <span class="title-hover-animation">MISC-data-1</span>
        </div>

        
            <div class="article-header">
                <div class="avatar">
                    <img src="/images/logo.jpg">
                </div>
                <div class="info">
                    <div class="author">
                        <span class="name">煤矿路口西</span>
                        
                            <span class="author-label">Lv4</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fas fa-edit"></i>&nbsp;2020-12-25 22:13:47
    </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fas fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/MISC/">MISC</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fas fa-file-word"></i>&nbsp;<span>3.1k 字</span>
        </span>
    
    
        <span class="article-min2read article-meta-item">
            <i class="fas fa-clock"></i>&nbsp;<span>13 分钟</span>
        </span>
    
    
        <span class="article-pv article-meta-item">
            <i class="fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                    </div>
                </div>
            </div>
        

        <div class="article-content markdown-body">
            <h3><span id="data1">Data[1]</span></h3>
<hr>
<p><strong>写在前面</strong></p>
<blockquote>
<p>浅薄笔者目前还无法完全消化理解wireshark相关流量分析的工具的内涵，先就针对遇到的题目类型做简单整理记录。</p>
</blockquote>
<h3><span id="1"><em>1</em></span></h3>
<p><strong>追踪流TCP+关键词搜索</strong></p>
<h4><span id="被嗅探的流量"></span></h4>
<blockquote>
<p>某黑客潜入到某公司内网通过嗅探抓取了一段文件传输的数据，该数据也被该公司截获，你能帮该公司分析他抓取的到底是什么文件的数据吗？ 注意：得到的 flag 请包上 flag{} 提交</p>
</blockquote>
<p>下载附件可知其中是一个.pcapng文件，用wireshark打开。</p>
<p><img lazyload src="/images/loading.svg" data-src="DLCaxH.png" alt="被嗅探的流量1"></p>
<p>追踪其中的tcp流（有的题会追踪http流），故👇</p>
<p><img lazyload src="/images/loading.svg" data-src="DLCURe.jpg" alt="被嗅探的流量2"></p>
<p>通过查找关键词flag可得👇</p>
<p><img lazyload src="/images/loading.svg" data-src="DLCwMd.png" alt="被嗅探的流量3"></p>
<h3><span id="2"><em>2</em></span></h3>
<p><strong>追踪流TCP+熟悉jpg的base64表示</strong></p>
<h4><span id="数据包中的线索"></span></h4>
<blockquote>
<p>公安机关近期截获到某网络犯罪团伙在线交流的数据包，但无法分析出具体的交流内容，聪明的你能帮公安机关找到线索吗？ 注意：得到的 flag 请包上 flag{} 提交</p>
</blockquote>
<p>下载附件得一pcapng文件，用wireshark打开。如题1所示打开TCP追踪👇</p>
<p><img lazyload src="/images/loading.svg" data-src="DLC0sA.png" alt="数据包中的线索1"></p>
<p>根据其中标记的“/9j/”部分，可得知该文件为base64形式下的jpg文件。补上文件头“data:image/jpeg;base64,”后在浏览器的地址栏中输入可得到图片</p>
<p><img lazyload src="/images/loading.svg" data-src="DLCBqI.png" alt="数据包中的线索2"></p>
<h3><span id="3"><em>3</em></span></h3>
<p><strong>追踪流+foremost分离+爆破</strong></p>
<h4><span id="被偷走的文件"></span></h4>
<blockquote>
<p>一黑客入侵了某公司盗取了重要的机密文件，还好管理员记录了文件被盗走时的流量，请分析该流量，分析出该黑客盗走了什么文件。 注意：得到的 flag 请包上 flag{} 提交</p>
</blockquote>
<p>wireshark追踪流可发现其中隐藏了一个rar文件👇</p>
<p><img lazyload src="/images/loading.svg" data-src="DLCtPO.png" alt="被偷走的文件1"></p>
<p>foremost分离后，可发现压缩包带锁，暴力破解可得👇</p>
<p><img lazyload src="/images/loading.svg" data-src="DLCNGD.png" alt="被偷走的文件2"></p>
<p>解得flag。</p>
<h3><span id="4"><em>4</em></span></h3>
<p><strong>追踪流+bool注入</strong></p>
<h4><span id="sqltest"></span></h4>
<blockquote>
<p>网站遭受到攻击了，还好我们获取到了全部网络流量。 链接: <a class="link" target="_blank" rel="noopener" href="https://pan.baidu.com/s/1AdQXVGKb6rkzqMLkSnGGBQ">https://pan.baidu.com/s/1AdQXVGKb6rkzqMLkSnGGBQ<i class="fas fa-external-link-alt"></i></a> 提取码: 34uu 注意：得到的 flag 请包上 flag{} 提交</p>
</blockquote>
<p>追踪http流后，观察到大量类似文件（后得知此为bool注入，查资料得<strong>在对一个字符进行bool判断时，被重复判断的ASCII值就是正确的字符</strong>）👇</p>
<p><img lazyload src="/images/loading.svg" data-src="DLCgJS.png" alt="sqltest"></p>
<p>拼接可得，改flag的ascii为</p>
<p>102 108 97 103 123 52 55 101 100 98 56 51 48 48 101 100 53 102 57 98 50 56 102 99 53 52 98 48 100 48 57 101 99 100 101 102 55 125</p>
<p>得f l a g { 4 7 e d b 8 3 0 0 e d 5 f 9 b 2 8 f c 5 4 b 0 d 0 9 e c d e f 7 }</p>
<h3><span id="5"><em>5</em></span></h3>
<p><strong>WireShark插入RSA密钥</strong></p>
<h4><span id="webnet0"></span></h4>
<blockquote>
<p>Try using a tool like Wireshark.How can you decrypt the TLS stream?</p>
</blockquote>
<p>给定一个pcapng文件和一密钥，依次点击编辑-&gt;首选项-&gt;RSA密钥-&gt;Add new keyfile后追踪HTTP流即可得到flag。</p>
<h3><span id="6"><em>6</em></span></h3>
<h4><span id="webnet1"></span></h4>
<blockquote>
<p>Try using a tool like Wireshark.How can you decrypt the TLS stream?</p>
</blockquote>
<p>同第五题的解法能得假flag:picoCTF{this.is.not.your.flag.anymore}
搜索可得真flag:picoCTF{honey.roasted.peanuts}</p>
<hr>
<h3><span id="7"><em>7</em></span></h3>
<p><strong>流量分析入门</strong></p>
<h4><span id="菜刀666"></span></h4>
<blockquote>
<p>流量分析，你能找到flag吗 注意：得到的 flag 请包上 flag{} 提交</p>
</blockquote>
<p>到手为一名为666666.pcapng的文件，丢进wireshark,其中大部分为TCP流，单个流追踪时没有结果，尝试导出。</p>
<p>按文件大小，锁定了一名为1.php的文件，save.</p>
<p><img lazyload src="/images/loading.svg" data-src="rMH9cF.jpg" alt="rMH9cF.jpg"></p>
<p><img lazyload src="/images/loading.svg" data-src="rMHGNt.jpg" alt="rMHGNt.jpg"></p>
<p>通过简单分析，能看出该Php文件中</p>
<p>1)post传入了action变量，对其进行base64解密</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">@ini_set(&quot;display_errors&quot;,&quot;0&quot;);@set_time_limit(0);@set_magic_quotes_runtime(0);echo(&quot;-&gt;|&quot;);;$f&#x3D;base64_decode($_POST[&quot;z1&quot;]);$c&#x3D;$_POST[&quot;z2&quot;];$c&#x3D;str_replace(&quot;\r&quot;,&quot;&quot;,$c);$c&#x3D;str_replace(&quot;\n&quot;,&quot;&quot;,$c);$buf&#x3D;&quot;&quot;;for($i&#x3D;0;$i&lt;strlen($c);$i+&#x3D;2)$buf.&#x3D;urldecode(&quot;%&quot;.substr($c,$i,2));echo(@fwrite(fopen($f,&quot;w&quot;),$buf)?&quot;1&quot;:&quot;0&quot;);;echo(&quot;|&lt;-&quot;);die();</span><br></pre></td></tr></table></figure>
<p>2)z1</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">D:\wamp64\www\upload\6666.jpg</span><br></pre></td></tr></table></figure>
<p>3)z2</p>
<p>文件头FFD8FF，可看出此为jpg文件后缀，另存为jpg文件后得到：</p>
<p><img lazyload src="/images/loading.svg" data-src="rMbtaR.jpg" alt="rMbtaR.jpg"></p>
<p>第二条路为对大文件进行分解。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">binwalk 666666.pcapng</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">binwalk -e 666666.pcapng</span><br></pre></td></tr></table></figure>
<p>得到诸多.xz及一个空白的flag.txt,说明路走对了。</p>
<p>发现一个加密的.zip文件，密码为此前的Th1s_1s_p4sswd_!!!</p>
<p>打开得flag</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">flag&#123;3OpWdJ-JP6FzK-koCMAK-VkfWBq-75Un2z&#125;</span><br></pre></td></tr></table></figure>
<h3><span id="8"><em>8</em></span></h3>
<h4><span id="john-in-the-middle"></span></h4>
<blockquote>
<p>注意：得到的 flag 请包上 flag{} 提交</p>
</blockquote>
<p>大量TCP和HTTP流量包，导出对象HTTP，得到大量文件👇</p>
<p><img lazyload src="/images/loading.svg" data-src="r1Wwd0.jpg" alt="r1Wwd0.jpg"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">java -jar C:\Users\16231\Desktop\Stegsolve.jar</span><br></pre></td></tr></table></figure>
<p>logo.png和scanlines.png通过Image Combiner进行色道分离后得到flag</p>
<p><img lazyload src="/images/loading.svg" data-src="r3dcod.jpg" alt="r3dcod.jpg"></p>
<blockquote>
<p>挖个坑，不明白这个操作是为啥以及怎么看出来的😂</p>
</blockquote>
<h3><span id="9"><em>9</em></span></h3>
<h4><span id="actf新生赛2020ntfs数据流"></span></h4>
<blockquote>
<p>注意：得到的 flag 请包上 flag{} 提交</p>
</blockquote>
<p>由于这道题比较简单，题干直接给出了考点，用NtfsStreamsEditor打开对应的压缩包，导出后查看得到flag</p>
<p><img lazyload src="/images/loading.svg" data-src="rf9J78.jpg" alt="rf9J78.jpg"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ACTF&#123;AAAds_nntfs_ffunn?&#125; </span><br></pre></td></tr></table></figure>
<h3><span id="10"><em>10</em></span></h3>
<h4><span id="间谍启示录"></span></h4>
<blockquote>
<p>在城际公路的小道上，罪犯G正在被警方追赶。警官X眼看他正要逃脱，于是不得已开枪击中了罪犯G。罪犯G情急之下将一个物体抛到了前方湍急的河流中，便头一歪突然倒地。警官X接近一看，目标服毒身亡。数分钟后，警方找到了罪犯遗失物体，是一个U盘，可惜警方只来得及复制镜像，U盘便报废了。警方现在拜托你在这个镜像中找到罪犯似乎想隐藏的秘密。 注意：得到的 flag 请包上 flag{} 提交</p>
</blockquote>
<p>得到一iso文件，本想着挂载啥的。</p>
<p>首先尝试foremost分离，得到</p>
<p>ole:= 2
rar:= 1
exe:= 1</p>
<p>看看压缩包，存在flag.exe,运行一下</p>
<p>得到 机密文件.txt</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Flag&#123;379:7b758:g7dfe7f19:9464f:4g9231&#125;</span><br></pre></td></tr></table></figure>
<h3><span id="11"><em>11</em></span></h3>
<h4><span id="vampn2020-公开赛拉胯的三条命令"></span></h4>
<p>先看了一波网上的WP，但是还是不太懂。多亏了pdsdt师傅耐心讲解，终于懂了哈哈哈哈哈</p>
<p>zip加后缀还原后，得到题目描述和nmapall.pcapng。</p>
<p>编辑-》首选项-》外观-》列</p>
<p>显示“目的端口”并按从小到大排序后，观察。</p>
<p>举例👇</p>
<p><img lazyload src="/images/loading.svg" data-src="r4wqv8.jpg" alt="r4wqv8.jpg"></p>
<p>这张图中可以看出，本机的35232端口给目标机（其实也是自己）的1端口发送SYN包，但是没有后续。故判断该端口为关闭状态。</p>
<p>其中3、4、6、7、9、13等端口都是一样的情况。</p>
<p>但是21端口就不一样了。</p>
<p>60176、33892等端口跟21分别进行了连续通信，说明该端口一定是打开的状态。</p>
<p>以此类推，21 22 631 801 3306</p>
<blockquote>
<p>当时还纠结了很久，为什么后面的端口一样满足要求，但是都不算。后明白因为这个流量是自己打自己，所以同一条流量会显示两遍。故5939后的都可以不看啦</p>
</blockquote>
<h3><span id="12"><em>12</em></span></h3>
<h4><span id="actf新生赛2020swp"></span></h4>
<blockquote>
<p>得到的 flag 请包上 flag{} 提交。</p>
</blockquote>
<p>得到wget.pcapng</p>
<p>流量分析！！</p>
<p>导出http流，得到一堆有的没的</p>
<p>观察，发现其中有hint.html</p>
<p><img lazyload src="/images/loading.svg" data-src="s8UNNV.jpg" alt="s8UNNV.jpg"></p>
<p>很好，不知道他在说什么</p>
<p>继续观察，发现一个名为secret.zip的压缩包，有东西！</p>
<p>存在名为flag的文件，丢进010</p>
<p>找到flag</p>
 <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">actf&#123;c5558bcf-26da-4f8b-b181-b61f3850b9e5&#125;</span><br></pre></td></tr></table></figure>
<h3><span id="13"><em>13</em></span></h3>
<h4><span id="安洵杯-2019attack"></span></h4>
<blockquote>
<p>得到的 flag 请包上 flag{} 提交。</p>
</blockquote>
<p>学到了流量分析新姿势</p>
<p>常规操作：</p>
<p>1）分析，导出HTTP流，得到lsass.dmp</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">lsass是Windows系统的一个进程，用于本地安全和登陆策略</span><br></pre></td></tr></table></figure>
<p>2)foremost分离得到加密压缩包</p>
<p>通过大神WP学到新姿势，<a class="link" target="_blank" rel="noopener" href="https://github.com/gentilkiwi/mimikatz/releases/tag/2.2.0-20200917">mimikatz<i class="fas fa-external-link-alt"></i></a>一个名叫猕猴桃的软件(内网渗透工具，可在lsass.exe进程中获取windows的账号明文密码)</p>
<p>以管理员权限打开后：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F;提升权限</span><br><span class="line">privilege::debug</span><br><span class="line">&#x2F;&#x2F;载入dmp文件</span><br><span class="line">sekurlsa::minidump lsass.dmp</span><br><span class="line">&#x2F;&#x2F;读取登陆密码</span><br><span class="line">sekurlsa::logonpasswords full</span><br><span class="line"></span><br><span class="line">得到密码</span><br><span class="line">W3lc0meToD0g3</span><br></pre></td></tr></table></figure>
<p>解压缩包得D0g3{3466b11de8894198af3636c5bd1efce2}</p>
<h3><span id="14"><em>14</em></span></h3>
<h4><span id="usb"></span></h4>
<blockquote>
<p>Do your konw usb?? 注意：得到的 flag 请包上 flag{} 提交</p>
</blockquote>
<p>得到233.rar及key.ftm，暂时放着，不知道有啥用</p>
<blockquote>
<p>做压缩包题最好用winrar。360会自动过滤掉一些东西。</p>
</blockquote>
<p>提示文件头损坏，对比大佬笔记https://www.freebuf.com/column/199854.html</p>
<p>常规文件头没问题，考虑【HEAD_TYPE应该是0x74而不是0x7A。】</p>
<p>得到233.png</p>
<p>分析一波，当Blue通道被置为0的时候出现了二维码！</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ci&#123;v3erf_0tygidv2_fc0&#125;</span><br></pre></td></tr></table></figure>
<p>图片的信息已经被榨干了，来处理key.ftm</p>
<p>查看二进制，能看到504b0304等字样，foremost可提取到压缩包</p>
<p>得到key.pcap一个流量</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">tshark -r key.pcap -T fields -e usb.capdata &gt; usbdata.txt</span><br></pre></td></tr></table></figure>
<p>通过脚本处理USB流量</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mappings &#x3D; &#123; 0x04:&quot;A&quot;, 0x05:&quot;B&quot;, 0x06:&quot;C&quot;, 0x07:&quot;D&quot;, 0x08:&quot;E&quot;,0x09:&quot;F&quot;, 0x0A:&quot;G&quot;, 0x0B:&quot;H&quot;, 0x0C:&quot;I&quot;, 0x0D:&quot;J&quot;, 0x0E:&quot;K&quot;,0x0F:&quot;L&quot;, 0x10:&quot;M&quot;, 0x11:&quot;N&quot;,0x12:&quot;O&quot;, 0x13:&quot;P&quot;, 0x14:&quot;Q&quot;,0x15:&quot;R&quot;, 0x16:&quot;S&quot;, 0x17:&quot;T&quot;, 0x18:&quot;U&quot;,0x19:&quot;V&quot;, 0x1A:&quot;W&quot;,0x1B:&quot;X&quot;, 0x1C:&quot;Y&quot;, 0x1D:&quot;Z&quot;, 0x1E:&quot;1&quot;, 0x1F:&quot;2&quot;, 0x20:&quot;3&quot;,0x21:&quot;4&quot;, 0x22:&quot;5&quot;, 0x23:&quot;6&quot;, 0x24:&quot;7&quot;, 0x25:&quot;8&quot;, 0x26:&quot;9&quot;,0x27:&quot;0&quot;, 0x28:&quot;\n&quot;, 0x2a:&quot;[DEL]&quot;, 0X2B:&quot; &quot;, 0x2C:&quot; &quot;, 0x2D:&quot;-&quot;, 0x2E:&quot;&#x3D;&quot;, 0x2F:&quot;[&quot;, 0x30:&quot;]&quot;, 0x31:&quot;\\&quot;, 0x32:&quot;~&quot;, 0x33:&quot;;&quot;,0x34:&quot;&#39;&quot;, 0x36:&quot;,&quot;, 0x37:&quot;.&quot; &#125;</span><br><span class="line">nums &#x3D; []</span><br><span class="line">keys &#x3D; open(&#39;usbdata.txt&#39;)</span><br><span class="line">for line in keys:</span><br><span class="line">    if line[0]!&#x3D;&#39;0&#39; or line[1]!&#x3D;&#39;0&#39; or line[3]!&#x3D;&#39;0&#39; or line[4]!&#x3D;&#39;0&#39;or line[9]!&#x3D;&#39;0&#39; or line[10]!&#x3D;&#39;0&#39; or line[12]!&#x3D;&#39;0&#39; or line[13]!&#x3D;&#39;0&#39;or line[15]!&#x3D;&#39;0&#39; or line[16]!&#x3D;&#39;0&#39; or line[18]!&#x3D;&#39;0&#39; or line[19]!&#x3D;&#39;0&#39;or line[21]!&#x3D;&#39;0&#39; or line[22]!&#x3D;&#39;0&#39;:</span><br><span class="line">        continue</span><br><span class="line">    nums.append(int(line[6:8],16))</span><br><span class="line">keys.close()</span><br><span class="line">output &#x3D; &quot;&quot;</span><br><span class="line">for n in nums:</span><br><span class="line">    if n &#x3D;&#x3D; 0 :</span><br><span class="line">        continue</span><br><span class="line">    if n in mappings:</span><br><span class="line">        output +&#x3D; mappings[n]</span><br><span class="line">    else:</span><br><span class="line">        output +&#x3D; &#39;[unknown]&#39;</span><br><span class="line">print &#39;output :\n&#39; + output</span><br></pre></td></tr></table></figure>
<p>得到</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">output :</span><br><span class="line">KEYXINAN</span><br></pre></td></tr></table></figure>
<p>至此，我们已经得到了一个密文ci{v3erf_0tygidv2_fc0}和密钥XINAN</p>
<p>需要密钥的文本加密，考虑维吉尼亚编码：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">fa&#123;i3eei_0llgvgn2_sc0&#125;</span><br></pre></td></tr></table></figure>
<p>由于没有看到flag头，一把梭得到</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">flag&#123;vig3ne2e_is_c00l&#125;</span><br></pre></td></tr></table></figure>
<h3><span id="15"><em>15</em></span></h3>
<h4><span id="suctf2018followme"></span></h4>
<blockquote>
<p>得到的 flag 请包上 flag{} 提交。来源：<a class="link" target="_blank" rel="noopener" href="https://github.com/hebtuerror404/CTF_competition_warehouse_2018">https://github.com/hebtuerror404/CTF_competition_warehouse_2018<i class="fas fa-external-link-alt"></i></a></p>
</blockquote>
<p>得到一个数据包，发现存在一堆HTTP流，文件名基本都为【login?_=】</p>
<p>猜测flag为登录密码，因为登录成功和失败有一定区别，故按大小排序，有明显不同的那个看看</p>
<p>得到flag</p>
<p><img lazyload src="/images/loading.svg" data-src="sNvl24.jpg" alt="sNvl24"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">SUCTF&#123;password_is_not_weak&#125;</span><br></pre></td></tr></table></figure>
<h3><span id="16"><em>16</em></span></h3>
<h4><span id="voip"></span></h4>
<blockquote>
<p>得到的 flag 请包上 flag{} 提交。</p>
</blockquote>
<p>得到一个流量包，全是RTP流量</p>
<p>学到了【电话-&gt;RTP-&gt;RTP流】或者根据题目名称【电话-&gt;VoIP通话】</p>
<p>接下来就是英语听力部分</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">flag&#123;9001IVR&#125;</span><br></pre></td></tr></table></figure>
<h3><span id="17"><em>17</em></span></h3>
<h4><span id="hdctf2019你能发现什么蛛丝马迹吗"></span></h4>
<blockquote>
<p>得到的 flag 请包上 flag{} 提交。</p>
</blockquote>
<p>漂亮的内存取证</p>
<p>利用volatility</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">volatility -f memory.img imageinfo</span><br></pre></td></tr></table></figure>
<p>查看可能版本</p>
<p><img lazyload src="/images/loading.svg" data-src="s4IdJg.jpg" alt="s4IdJg"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">volatility -f memory.img --profile&#x3D;Win2003SP1x86 pslist</span><br></pre></td></tr></table></figure>
<p>查看进程</p>
<p><img lazyload src="/images/loading.svg" data-src="s4TKvd.jpg" alt="s4TKvd"></p>
<p>发现DumpIt.exe</p>
<p>查看cmd命令使用记录</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">volatility -f memory.img --profile&#x3D;Win2003SP1x86 cmdscan</span><br></pre></td></tr></table></figure>
<p><img lazyload src="/images/loading.svg" data-src="s4Tn8e.jpg" alt="s4Tn8e"></p>
<p>发现flag的痕迹</p>
<p>dump下来</p>
<p><img lazyload src="/images/loading.svg" data-src="s4TmCD.jpg" alt="s4TmCD"></p>
<p>foremost分离</p>
<p>得到output文件夹</p>
<p>有东西!</p>
<p>得到一张二维码</p>
<p>扫描后</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">jfXvUoypb8p3zvmPks8kJ5Kt0vmEw0xUZyRGOicraY4&#x3D;</span><br></pre></td></tr></table></figure>
<p>和</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">key:Th1s_1s_K3y00000</span><br><span class="line">viL1234567890123456</span><br></pre></td></tr></table></figure>
<p>AES带密码带偏移量解密http://tool.chacuo.net/cryptaes</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">flag&#123;F0uNd_s0m3th1ng_1n_M3mory&#125;</span><br></pre></td></tr></table></figure>
<h3><span id="18"><em>18</em></span></h3>
<h4><span id="百里挑一"></span></h4>
<blockquote>
<p>好多漂亮的壁纸，赶快挑一张吧！ 注意：得到的 flag 请包上 flag{} 提交</p>
</blockquote>
<p>得到很多TCP数据包，导出HTTP数据能发现题目提到的大量壁纸。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">strings *|grep flag</span><br></pre></td></tr></table></figure>
<p>未果</p>
<p>花了点时间安装大佬们提到的exiftool</p>
<p>安装ExifTool
Windows：<a class="link" target="_blank" rel="noopener" href="https://exiftool.org/">下载ExifTool可执行文件<i class="fas fa-external-link-alt"></i></a>（名为：exiftool-x.x.zip），解压得到exiftool(-k).exe，重命名为exiftool.exe，通过CMD命令行运行。
Linux：<a class="link" target="_blank" rel="noopener" href="https://exiftool.org/">下载ExifTool发行包<i class="fas fa-external-link-alt"></i></a>（名为：Image-ExifTool-x.x.tar.gz），解压后运行./exiftool即可。或通过perl <a class="link" target="_blank" rel="noopener" href="http://Makefile.PL">Makefile.PL<i class="fas fa-external-link-alt"></i></a> &amp;&amp; make install编译安装。
MacOS：<a class="link" target="_blank" rel="noopener" href="https://exiftool.org/">下载ExifTool安装包<i class="fas fa-external-link-alt"></i></a>（名为ExifTool-x.x.dmg），安装后在终端执行exiftool使用。
详细的安装文档，参考ExifTool主页安装文档</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cb4bbe1c-bffe-4101-a9de-4de40bca4558 (1)# </span><br><span class="line">exiftool *|grep flag</span><br><span class="line">XP Comment                      : 恭喜你！找到一半了，还有另一半哦！flag&#123;ae58d0408e26e8f</span><br></pre></td></tr></table></figure>
<p>得到了一半的flag</p>
<p>后半部分目前不明白是咋推出来的</p>
<p><img lazyload src="/images/loading.svg" data-src="so2tln.png" alt="so2tln"></p>
<p>2.6.a.3.c.0.5.8.9.d.2.3.e.d.e.e.c.}</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">flag&#123;ae58d0408e26e8f26a3c0589d23edeec&#125;</span><br></pre></td></tr></table></figure>
<h3><span id="19"><em>19</em></span></h3>
<h4><span id="bsidessf2019zippy"></span></h4>
<blockquote>
<p>得到的 flag 请包上 flag{} 提交</p>
</blockquote>
<p>得到一个TCP流量的数据包，追踪几个流量，分别得到了</p>
<p><img lazyload src="/images/loading.svg" data-src="sT5gMQ.jpg" alt="sT5gMQ"></p>
<p><img lazyload src="/images/loading.svg" data-src="sT56xg.jpg" alt="sT56xg"></p>
<p>第一张图开头为PK，以原始数据保存后更改后缀名为.zip</p>
<p>第二章图能得到加密压缩包的密码</p>
<p>打开压缩包得到</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">CTF&#123;this_flag_is_your_flag&#125;</span><br></pre></td></tr></table></figure>
<h3><span id="20"><em>20</em></span></h3>
<h4><span id="bsidessf2019table-tennis"></span></h4>
<blockquote>
<p>得到的 flag 请包上 flag{} 提交</p>
</blockquote>
<p>注意到ICMP流中出现了</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;html&gt;&lt;head&gt;&lt;title&gt;</span><br></pre></td></tr></table></figure>
<p>等字样，挨个誊写</p>
<p><img lazyload src="/images/loading.svg" data-src="6p32X8.png" alt="6p32X8"></p>
<p><img lazyload src="/images/loading.svg" data-src="6p3g6f.png" alt="6p3g6f"></p>
<p><img lazyload src="/images/loading.svg" data-src="6p3c1P.png" alt="6p3c1P"></p>
<p><img lazyload src="/images/loading.svg" data-src="6p3sfI.png" alt="6p3sfI"></p>
<p><img lazyload src="/images/loading.svg" data-src="6p36pt.png" alt="6p36pt"></p>
<p><img lazyload src="/images/loading.svg" data-src="6p3f0g.png" alt="6p3f0g"></p>
<p><img lazyload src="/images/loading.svg" data-src="6p3h7Q.png" alt="6p3h7Q"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">writeat(ob(&quot;Q1RGe0p1c3RBUzBuZ0FiMHV0UDFuZ1Awbmd9&quot;));</span><br></pre></td></tr></table></figure>
<p>base64解码</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">CTF&#123;JustAS0ngAb0utP1ngP0ng&#125;</span><br></pre></td></tr></table></figure>

        </div>

        
            <div class="post-copyright-info">
                <div class="article-copyright-info-container">
    <ul>
        <li>本文标题：MISC-data-1</li>
        <li>本文作者：煤矿路口西</li>
        <li>创建时间：2020-12-25 22:13:47</li>
        <li>
            本文链接：http://www.mklkx.xyz/2020/12/25/MISC-data-1/
        </li>
        <li>
            版权声明：本博客所有文章除特别声明外，均采用 <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">BY-NC-SA</a> 许可协议。转载请注明出处！
        </li>
    </ul>
</div>

            </div>
        

        
            <div class="article-nav">
                
                    <div class="article-prev">
                        <a class="prev"
                           rel="prev"
                           href="/2021/01/16/MISC-2/"
                        >
                            <span class="left arrow-icon flex-center">
                              <i class="fas fa-chevron-left"></i>
                            </span>
                            <span class="title flex-center">
                                <span class="post-nav-title-item">MISC-2</span>
                                <span class="post-nav-item">上一篇</span>
                            </span>
                        </a>
                    </div>
                
                
                    <div class="article-next">
                        <a class="next"
                           rel="next"
                           href="/2020/12/25/MISC-audio-1/"
                        >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">MISC-audio-1</span>
                                <span class="post-nav-item">下一篇</span>
                            </span>
                            <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        

        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            <footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
              <span>2019</span>&nbsp;-&nbsp;
            
            2022&nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;<a href="/">煤矿路口西</a>
        </div>
        
            <script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="website-count info-item">
                
                    <span id="busuanzi_container_site_uv">
                        访问人数&nbsp;<span id="busuanzi_value_site_uv"></span>&ensp;
                    </span>
                
                
                    <span id="busuanzi_container_site_pv">
                        总访问量&nbsp;<span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="theme-info info-item">
            由 <a target="_blank" href="https://hexo.io">Hexo</a> 驱动&nbsp;|&nbsp;主题&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.4.3</a>
        </div>
        
            <div class="icp-info info-item"><a target="_blank" rel="nofollow" href="https://beian.miit.gov.cn">冀ICP备2021010275号</a></div>
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item page-aside-toggle">
                <i class="fas fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-expand-width flex-center">
            <i class="fas fa-arrows-alt-h"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="fas fa-arrow-up"></i>
            </li>
        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
    </ul>
</div>

    </div>

    
        <aside class="page-aside">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">1.</span> <span class="nav-text">Data[1]</span></a></li><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">2.</span> <span class="nav-text">1</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">2.1.</span> <span class="nav-text"></span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">3.</span> <span class="nav-text">2</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">3.1.</span> <span class="nav-text"></span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">4.</span> <span class="nav-text">3</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">4.1.</span> <span class="nav-text"></span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">5.</span> <span class="nav-text">4</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">5.1.</span> <span class="nav-text"></span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">6.</span> <span class="nav-text">5</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">6.1.</span> <span class="nav-text"></span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">7.</span> <span class="nav-text">6</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">7.1.</span> <span class="nav-text"></span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">8.</span> <span class="nav-text">7</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">8.1.</span> <span class="nav-text"></span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">9.</span> <span class="nav-text">8</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">9.1.</span> <span class="nav-text"></span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">10.</span> <span class="nav-text">9</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">10.1.</span> <span class="nav-text"></span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">11.</span> <span class="nav-text">10</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">11.1.</span> <span class="nav-text"></span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">12.</span> <span class="nav-text">11</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">12.1.</span> <span class="nav-text"></span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">13.</span> <span class="nav-text">12</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">13.1.</span> <span class="nav-text"></span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">14.</span> <span class="nav-text">13</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">14.1.</span> <span class="nav-text"></span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">15.</span> <span class="nav-text">14</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">15.1.</span> <span class="nav-text"></span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">16.</span> <span class="nav-text">15</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">16.1.</span> <span class="nav-text"></span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">17.</span> <span class="nav-text">16</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">17.1.</span> <span class="nav-text"></span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">18.</span> <span class="nav-text">17</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">18.1.</span> <span class="nav-text"></span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">19.</span> <span class="nav-text">18</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">19.1.</span> <span class="nav-text"></span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">20.</span> <span class="nav-text">19</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">20.1.</span> <span class="nav-text"></span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">21.</span> <span class="nav-text">20</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">21.1.</span> <span class="nav-text"></span></a></li></ol></li></ol>
    </div>
</div>
        </aside>
    

    <div class="image-viewer-container">
    <img src="">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="搜索..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="popup-btn-close">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>




<script src="/js/utils.js"></script>

<script src="/js/main.js"></script>

<script src="/js/header-shrink.js"></script>

<script src="/js/back2top.js"></script>

<script src="/js/dark-light-toggle.js"></script>



    
<script src="/js/local-search.js"></script>




    
<script src="/js/code-copy.js"></script>




    
<script src="/js/lazyload.js"></script>



<div class="post-scripts pjax">
    
        
<script src="/js/left-side-toggle.js"></script>

<script src="/js/libs/anime.min.js"></script>

<script src="/js/toc.js"></script>

    
</div>


    
<script src="/js/libs/pjax.min.js"></script>

<script>
    window.addEventListener('DOMContentLoaded', () => {
        window.pjax = new Pjax({
            selectors: [
                'head title',
                '.page-container',
                '.pjax'
            ],
            history: true,
            debug: false,
            cacheBust: false,
            timeout: 0,
            analytics: false,
            currentUrlFullReload: false,
            scrollRestoration: false,
            // scrollTo: true,
        });

        document.addEventListener('pjax:send', () => {
            KEEP.utils.pjaxProgressBarStart();
        });

        document.addEventListener('pjax:complete', () => {
            KEEP.utils.pjaxProgressBarEnd();
            window.pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
            KEEP.refresh();
        });
    });
</script>



</body>
</html>
